<h2><%= @product.title %></h2>
<h2><%= @product.description %></h2>
<p>By <%= @product.user&.full_name || "[deleted]" %></p>
<h2>price:$ <%= @product.price %></h2>
<% if can?(:manage, @product) %>
<%= link_to 'Edit', edit_product_path(@product) %>
  <%=
    link_to(
      'Delete',
      product_path(@product),
      method: :delete,
      data: {confirm: 'Are you sure?'}
    )
  %>
<% end %>

<%= form_for [@product, @review] do |f| %>
  <% if @review.errors.present? %>
    <p>
      <%= @review.errors.full_messages.join(', ') %>
    </p>
  <% end %>

  <div>
    <p> Comments:<%= f.text_area :body %></p>
    <p> Rating: <%= f.number_field :rating , in:1..5 %></p>
  </div>

  <%= f.submit %>
<% end %>




<div class="review-list">

  <div>
      <% @reviews.each do |review| %>
        <% if review.is_hidden? %>
        <div style="color:lightgrey">
          <div>
            <p><strong>Rating:</strong> <%= review.rating %></p>
            <p><strong>Reviews:</strong> <%= review.body %></p>
            <p><strong>User:</strong><%= review.user.full_name %></p>
            <p><strong>Created At:</strong> <%= time_ago_in_words(review.created_at) %> ago</p>
            <% if can?(:destroy, review)%>
              <%= link_to(
                'Delete',
                product_review_path(@product, review),
                data: {confirm: 'Are you sure?'},
                method: :delete
              ) %>
            <% end %>
            <% if can?(:manage, review) %>
              <%= link_to 'Hide/ Unhide', edit_product_review_path(@product, review) %>
            <% end %>
        </div>
      </div>
        <% elsif !review.is_hidden?  %>

            <div>
              <p><strong>Rating:</strong> <%= review.rating %></p>
              <p><strong>Reviews:</strong> <%= review.body %></p>
              <p><strong>User:</strong><%= review.user.full_name %></p>
              <p><strong>Created At:</strong> <%= time_ago_in_words(review.created_at) %> ago</p>
              <% if can?(:destroy, review)%>
                <%= link_to(
                  'Delete',
                  product_review_path(@product, review),
                  data: {confirm: 'Are you sure?'},
                  method: :delete
                ) %>
              <% end %>
              <% if can?(:manage, review) %>
                <%= link_to 'Hide/ Unhide', edit_product_review_path(@product, review) %>
              <% end %>
          </div>

        <% end %>
      <% end %>
    </div>
</div>
